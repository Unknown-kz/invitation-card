
import { GoogleGenAI } from "@google/genai";

const ai = new GoogleGenAI({ apiKey: process.env.API_KEY || '' });

export const getGuestAssistance = async (query: string) => {
  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-flash-preview',
      contents: query,
      config: {
        systemInstruction: `–°—ñ–∑ –ï—Ä–∂–∞–Ω –º–µ–Ω –ì“Ø–ª—Å–∞—Ä–∞–Ω—ã“£ 50 –∂—ã–ª–¥—ã“õ –ê–ª—Ç—ã–Ω —Ç–æ–π—ã–Ω—ã“£ (Altyn Toi) —Ü–∏—Ñ—Ä–ª—ã“õ –∫”©–º–µ–∫—à—ñ—Å—ñ—Å—ñ–∑. 
        –¢–µ–∫ “õ–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω–¥–µ, –∂—ã–ª—ã –∂”ô–Ω–µ —Å—ã–ø–∞–π—ã (¬´–°—ñ–∑¬ª –¥–µ–ø) –∂–∞—É–∞–ø –±–µ—Ä—ñ“£—ñ–∑.
        –ú–µ—Ä–µ–∫–µ –∏–µ–ª–µ—Ä—ñ: –ï—Ä–∂–∞–Ω –º–µ–Ω –ì“Ø–ª—Å–∞—Ä–∞, –æ—Ç–∞—É “õ“±—Ä“ì–∞–Ω–¥–∞—Ä—ã–Ω–∞ 50 –∂—ã–ª –±–æ–ª–¥—ã.
        ”®—Ç—É –æ—Ä–Ω—ã: –ê—Å—Ç–∞–Ω–∞ “õ–∞–ª–∞—Å—ã, ¬´–ê“õ—Ç—ñ–ª–µ–∫¬ª –º–µ–π—Ä–∞–º—Ö–∞–Ω–∞—Å—ã (–ò—Å–∞—Ç–∞–π –ë–∞—Ç—ã—Ä –∫”©—à–µ—Å—ñ, 58).
        –ú—ñ–Ω–µ–∑—ñ“£—ñ–∑: ”®—Ç–µ “õ–æ–Ω–∞“õ–∂–∞–π, –∫—ñ—à—ñ–ø–µ–π—ñ–ª, –æ—Ç–±–∞—Å—ã–ª—ã“õ –¥–æ—Å —Å–∏—è“õ—Ç—ã –∂—ã–ª—ã —Å”©–π–ª–µ–π—Å—ñ–∑.
        –ï—Ä–µ–∂–µ–ª–µ—Ä:
        1. –†–æ–±–æ—Ç —Å–∏—è“õ—Ç—ã —Å”©–π–ª–µ–º–µ“£—ñ–∑. ¬´–ë—ñ–∑–¥—ñ“£ –º–µ—Ä–µ–∫–µ–≥–µ “õ–æ—à –∫–µ–ª–¥—ñ“£—ñ–∑!¬ª –Ω–µ–º–µ—Å–µ ¬´–°—ñ–∑–¥—ñ –∫”©—Ä—É –±—ñ–∑ “Ø—à—ñ–Ω “Ø–ª–∫–µ–Ω –º”ô—Ä—Ç–µ–±–µ¬ª —Å–∏—è“õ—Ç—ã —Å”©–∑–¥–µ—Ä–¥—ñ “õ–æ–ª–¥–∞–Ω—ã“£—ã–∑.
        2. –ú–µ–π—Ä–∞–º—Ö–∞–Ω–∞–Ω—ã“£ –æ—Ä–Ω–∞–ª–∞—Å—É—ã–Ω (2GIS “õ–æ–ª–¥–∞–Ω—É–¥—ã “±—Å—ã–Ω—ã“£—ã–∑), —Ç–æ–π –±–∞“ì–¥–∞—Ä–ª–∞–º–∞—Å—ã–Ω –∂”ô–Ω–µ –∫–∏—ñ–º “Ø–ª–≥—ñ—Å—ñ–Ω (–ê–ª—Ç—ã–Ω —Ç“Ø—Å—Ç—ñ –¥–µ—Ç–∞–ª—å–¥–∞—Ä—ã –±–∞—Ä –∫–ª–∞—Å—Å–∏–∫–∞–ª—ã“õ —Å—Ç–∏–ª—å) —Ç“Ø—Å—ñ–Ω–¥—ñ—Ä—ñ“£—ñ–∑.
        3. –ï–≥–µ—Ä –±—ñ—Ä–µ—É —Å—ã–π–ª—ã“õ —Ç—É—Ä–∞–ª—ã —Å“±—Ä–∞—Å–∞, ¬´–ï“£ “Ø–ª–∫–µ–Ω —Å—ã–π–ª—ã“õ - —Å—ñ–∑–¥—ñ“£ “õ–∞—Ç—ã—Å—É—ã“£—ã–∑¬ª –¥–µ–ø –∂–∞—É–∞–ø –±–µ—Ä—ñ“£—ñ–∑.
        4. –®“±“ì—ã–ª —Å“±—Ä–∞“õ—Ç–∞—Ä –±–æ–π—ã–Ω—à–∞ –ñ“±–º–∞–Ω–º–µ–Ω (87081298373) —Ö–∞–±–∞—Ä–ª–∞—Å—É–¥—ã —Å“±—Ä–∞“£—ã–∑.
        5. –ñ–∞—É–∞–ø—Ç–∞—Ä–¥—ã “õ—ã—Å“õ–∞, –±—ñ—Ä–∞“õ ”©—Ç–µ –º–∞–∑–º“±–Ω–¥—ã –∂”ô–Ω–µ –∂—ã–ª—ã –µ—Ç—ñ–ø –∂–∞–∑—ã“£—ã–∑. ü•Ç‚ú®`,
      }
    });
    return response.text || "–°”ô–ª–µ–º–µ—Ç—Å—ñ–∑ –±–µ! –ú–µ–Ω –ï—Ä–∂–∞–Ω –º–µ–Ω –ì“Ø–ª—Å–∞—Ä–∞–Ω—ã“£ –ê–ª—Ç—ã–Ω —Ç–æ–π—ã–Ω—ã“£ –∫”©–º–µ–∫—à—ñ—Å—ñ–º—ñ–Ω. –°—ñ–∑–≥–µ “õ–∞–ª–∞–π –∫”©–º–µ–∫—Ç–µ—Å–µ –∞–ª–∞–º—ã–Ω?";
  } catch (error) {
    console.error("AI Assistant error:", error);
    return "–ö–µ—à—ñ—Ä—ñ“£—ñ–∑, –º–µ–Ω “õ–∞–∑—ñ—Ä –±–∞—Å“õ–∞ “õ–æ–Ω–∞“õ—Ç–∞—Ä–¥—ã “õ–∞—Ä—Å—ã –∞–ª—ã–ø –∂–∞—Ç—ã—Ä–º—ã–Ω. –ñ“±–º–∞–Ω“ì–∞ 87081298373 –Ω”©–º—ñ—Ä—ñ –±–æ–π—ã–Ω—à–∞ —Ö–∞–±–∞—Ä–ª–∞—Å—Å–∞“£—ã–∑ –±–æ–ª–∞–¥—ã. –°—ñ–∑–¥—ñ –∞—Å—ã“ì–∞ –∫“Ø—Ç–µ–º—ñ–∑!";
  }
};
